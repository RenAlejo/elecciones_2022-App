const url=window.location.hostname.includes("localhost")?"http://localhost:8181/api/":"https://votaciones2022.herokuapp.com/api/";let token=localStorage.getItem("token")||"",formJurado={e11:0,votosUrna:0,votosIncinerados:0},formReg={rh:0,gp:0,votoblanco:0,votonulo:0,votonomarcado:0,totalVotos:0},formMesa={totalVotosMesa:0},usuario=null;if(token.length<=10)throw window.location="/",new Error("El token no es vÃ¡lido");const validateJWT=async()=>{const o=await fetch(url+"auth",{headers:{Authorization:token}}),{user:e,token:t}=await o.json();localStorage.setItem("token",t),usuario=e,token=t},main=async()=>{await validateJWT()},getDepartamentos=async()=>{const o=await fetch(url+"departamentos",{headers:{Authorization:token}}),{...e}=await o.json(),t=document.querySelector("#departamentosSelect");for(let o in e.departamentos){let a=document.createElement("option");a.value=e.departamentos[o].cod_dep,a.text=e.departamentos[o].departamento,t.add(a)}},clearSelect=o=>{for(let e=o.options.length;e>=0;e--)o.remove(e)},getMunicipios=async o=>{const e=await fetch(url+`municipios/${o}`,{headers:{Authorization:token}}),{...t}=await e.json();let a=document.querySelector("#municipiosSelect");a.disabled=!1,clearSelect(a),0===parseInt(o)&&(a.disabled=!0);for(let o in t.municipios){let e=document.createElement("option");e.value=t.municipios[o].codigo_mun,e.text=t.municipios[o].municipio,a.add(e)}},sumJurado=o=>{e11="e11"==o.desc?formJurado.e11=o.value:0,votosUrna="votosurna"==o.desc?formJurado.votosUrna=o.value:0,votosIncinerados="votosincinerados"==o.desc?formJurado.votosIncinerados=o.value:0;let e=0;if(0!=formJurado.e11&&parseInt(formJurado.votosUrna)+parseInt(formJurado.votosIncinerados)!=0){let o=document.getElementById("juradodiferencia");e=parseInt(formJurado.votosUrna)+parseInt(formJurado.votosIncinerados)-parseInt(formJurado.e11),e<0?(e*=-1,o.classList.remove("btn-success"),o.classList.add("btn-danger"),document.getElementById("total").innerHTML=e):0!=e?(o.classList.remove("btn-success"),o.classList.add("btn-danger"),document.getElementById("total").innerHTML=e):(o.classList.remove("btn-danger"),o.classList.add("btn-success"),document.getElementById("total").innerHTML=0)}},sumReg=o=>{rh="rh"==o.desc?formReg.rh=o.value:0,gp="gp"==o.desc?formReg.gp=o.value:0,votoblanco="votoblanco"==o.desc?formReg.votoblanco=o.value:0,votonulo="votonulo"==o.desc?formReg.votonulo=o.value:0,votonomarcado="votonomarcado"==o.desc?formReg.votonomarcado=o.value:0;var e=0;e=document.getElementById("totalVotosReg").innerHTML,e=null==e||null==e||""==e?0:e,e=parseInt(formReg.rh)+parseInt(formReg.gp)+parseInt(formReg.votoblanco)+parseInt(formReg.votonulo)+parseInt(formReg.votonomarcado),formReg.totalVotos=e,document.getElementById("totalVotosReg").innerHTML=e,0!=parseInt(formMesa.totalVotosMesa)&&sumMesa(parseInt(formMesa.totalVotosMesa))},sumMesa=o=>{let e=0;formMesa.totalVotosMesa=o,e=parseInt(formReg.totalVotos)-parseInt(o);let t=document.getElementById("mesadiferencia"),a=document.getElementById("diferenciaVotosMesa");e<0?(e*=-1,t.classList.remove("btn-success"),t.classList.add("btn-danger"),a.innerHTML=e):0!=e?(t.classList.remove("btn-success"),t.classList.add("btn-danger"),a.innerHTML=e):(t.classList.remove("btn-danger"),t.classList.add("btn-success"),a.innerHTML=0)};main(),getDepartamentos();