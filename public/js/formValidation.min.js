const votosForm=document.querySelector("#formVotos"),sendFormButton=document.querySelector("#sendformbutton"),divErrors=document.getElementById("errors"),divTotal=document.querySelector("#total"),divTotalVotosReg=document.querySelector("#totalVotosReg"),btnMesaDiferencia=document.querySelector("#mesadiferencia"),btnJuradoDiferencia=document.querySelector("#juradodiferencia"),divDiferenciaVotosMesa=document.querySelector("#diferenciaVotosMesa");votosForm.addEventListener("submit",e=>{e.preventDefault(),sendFormButton.disabled=!0;const o={};for(let e of votosForm.elements)e.name.length>0&&(o[e.name]=e.value);sendFormButton.innerHTML='Enviando Formulario <div class="spinner-grow spinner-grow-sm justify-content-md-right" role="status"><span class="visually-hidden"></span></div>',setTimeout(()=>{sendFormButton.innerHTML='Validando Información <div class="spinner-grow spinner-grow-sm justify-content-md-right" role="status"><span class="visually-hidden"></span></div>',setTimeout(()=>{fetch(url+"form",{method:"POST",body:JSON.stringify(o),headers:{Authorization:token,"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{if(e.errors){for(let o in e.errors){divErrors.innerHTML=`<div class="alert alert-danger"><i class="bi bi-exclamation-circle"></i> • ${e.errors[o].msg} </div><br>`;let r=e.errors[o].param;"codigo_mun"==r&&(r="municipiosSelect"),"codigo_dep"==r&&(r="departamentosSelect"),document.getElementById(r).classList.add("is-invalid")}return sendFormButton.innerHTML="Enviar Formulario",console.error(e)}divErrors.innerHTML='<div class="alert alert-success"><i class="bi bi-check-circle"></i> Formulario registrado con éxito. </div>',sendFormButton.innerHTML="Enviar Formulario",total.innerHTML=0,divTotalVotosReg.innerHTML=0,divDiferenciaVotosMesa.innerHTML=0,mesadiferencia.classList.remove("btn-danger"),mesadiferencia.classList.add("btn-success"),btnJuradoDiferencia.classList.remove("btn-danger"),btnJuradoDiferencia.classList.add("btn-success");for(let o of votosForm.elements)o.name.length>0&&"codigo_dep"!=o.name&&"codigo_mun"!=o.name&&(o.value="",o.classList.remove("is-invalid")),"codigo_dep"==o.name&&""!=e.userinfo.departamento&&(o.value=e.userinfo.departamento,o.classList.remove("is-invalid")),"codigo_mun"==o.name&&""!=e.userinfo.municipio&&(o.value=e.userinfo.municipio,o.classList.remove("is-invalid"));formJurado={e11:0,votosUrna:0,votosIncinerados:0},formReg={rh:0,gp:0,votoblanco:0,votonulo:0,votonomarcado:0,totalVotos:0},formMesa={totalVotosMesa:0},sendFormButton.disabled=!1,setTimeout(()=>{divErrors.innerHTML=""},2500)}).catch(e=>{console.log(e)})},1e3)},1e3)});