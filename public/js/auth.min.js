const url=window.location.hostname.includes("localhost")?"http://localhost:8181/api/auth/":"https://votaciones2022.herokuapp.com/api/auth/",signInForm=document.querySelector("form"),signInButton=document.getElementById("loginSubmitButton"),divErrors=document.getElementById("erros");let authToken=localStorage.getItem("token")||"";authToken&&(window.location="/views/form.html"),signInForm.addEventListener("submit",e=>{e.preventDefault();const n={};for(let e of signInForm.elements)e.name.length>0&&(n[e.name]=e.value);n.username&&n.password&&(signInButton.innerHTML='Ingresar <div class="spinner-grow spinner-grow-sm justify-content-md-right" role="status"><span class="visually-hidden"></span></div>',setTimeout(()=>{fetch(url+"login",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(({msg:e,token:n})=>{if(e)return divErrors.innerHTML=`<div class="alert alert-danger"><i class="bi bi-exclamation-circle"></i> ${e} </div>`,signInButton.innerHTML="Ingresar",signInForm.classList.remove("was-validated"),document.getElementById("username").classList.add("is-invalid"),document.getElementById("password").classList.add("is-invalid"),console.error(e);localStorage.setItem("token",n),window.location="/views/form.html"}).catch(e=>{console.log(e)})},1e3))});